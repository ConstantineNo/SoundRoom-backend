# 数据库表结构文档

**日期**: 2025-12-09
**时间**: 22:15

## 1. Users 表 (users)
描述用户账户信息。

| 字段名 | 类型 | 长度 | 约束 | 描述 |
| :--- | :--- | :--- | :--- | :--- |
| id | Integer | - | PK, Index | 用户ID |
| username | String | 50 | Unique, Index | 用户名 |
| hashed_password | String | 100 | - | 密码哈希 |
| role | String | 20 | Default='user' | 用户角色 |

## 2. Scores 表 (scores)
描述曲谱基本信息。

| 字段名 | 类型 | 长度 | 约束 | 描述 |
| :--- | :--- | :--- | :--- | :--- |
| id | Integer | - | PK, Index | 曲谱ID |
| title | String | 100 | - | 曲谱标题 |
| song_key | String | 10 | - | 原曲调号 |
| flute_key | String | 10 | - | 笛子调号 |
| fingering | String | 10 | - | 指法 |
| image_path | String | 255 | - | 图片路径 |
| audio_path | String | 255 | - | 音频路径 |
| tags | JSON | - | Nullable | 标签列表 |
| abc_source | Text | - | Nullable | ABC乐谱源码 |
| structured_data | JSON | - | Nullable | 解析后的结构化数据 |

## 3. Playlists 表 (playlists)
描述用户播放列表。

| 字段名 | 类型 | 长度 | 约束 | 描述 |
| :--- | :--- | :--- | :--- | :--- |
| id | Integer | - | PK, Index | 列表ID |
| user_id | Integer | - | FK(users.id) | 所属用户 |
| name | String | 100 | - | 列表名称 |

## 4. PlaylistItems 表 (playlist_items)
描述播放列表项（关联曲谱）。

| 字段名 | 类型 | 长度 | 约束 | 描述 |
| :--- | :--- | :--- | :--- | :--- |
| id | Integer | - | PK, Index | 条目ID |
| playlist_id | Integer | - | FK(playlists.id) | 列表ID |
| score_id | Integer | - | FK(scores.id) | 曲谱ID |
| sort_order | Integer | - | Default=0 | 排序序号 |

## 5. Recordings 表 (recordings)
描述用户录音记录。

| 字段名 | 类型 | 长度 | 约束 | 描述 |
| :--- | :--- | :--- | :--- | :--- |
| id | Integer | - | PK, Index | 录音ID |
| user_id | Integer | - | FK(users.id) | 用户ID |
| score_id | Integer | - | FK(scores.id) | 曲谱ID |
| file_path | String | 255 | - | 文件路径 |
